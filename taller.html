<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>TallerPRO360 | Panel del Taller</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#020617" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; font-family: 'Inter', sans-serif; }

    body {
      margin: 0;
      background: #020617;
      color: #E5E7EB;
    }

    header {
      padding: 16px;
      background: #020617;
      border-bottom: 1px solid #0F172A;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 18px;
      margin: 0;
      font-weight: 700;
    }

    .btn-new {
      background: linear-gradient(90deg, #38BDF8, #0EA5E9);
      border: none;
      padding: 10px 14px;
      border-radius: 10px;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
    }

    .container {
      padding: 16px;
    }

    .order-card {
      background: #0F172A;
      border-radius: 14px;
      padding: 16px;
      margin-bottom: 14px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    }

    .order-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .placa {
      font-size: 16px;
      font-weight: 700;
    }

    .estado {
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 20px;
      background: #1E293B;
      font-weight: 600;
    }

    .info {
      font-size: 13px;
      color: #CBD5F5;
      margin-bottom: 6px;
    }

    .timeline {
      display: flex;
      gap: 6px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .step {
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 8px;
      background: #020617;
      border: 1px solid #1E293B;
    }

    .step.active {
      background: #38BDF8;
      color: #020617;
      font-weight: 700;
    }

    footer {
      height: 70px;
    }
  </style>
</head>

<body>

<header>
  <h1>ðŸš— TallerPRO360</h1>
  <button class="btn-new" onclick="crearOrden()">+ Orden</button>
</header>

<div class="container" id="ordersContainer">
  <!-- Ã“rdenes dinÃ¡micas -->
</div>

<footer></footer>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    query,
    orderBy,
    onSnapshot,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "TU_API_KEY",
    authDomain: "TU_AUTH_DOMAIN",
    projectId: "TU_PROJECT_ID",
    storageBucket: "TU_STORAGE_BUCKET",
    messagingSenderId: "TU_MESSAGING_ID",
    appId: "TU_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const estados = [
    "INGRESO",
    "DIAGNOSTICO",
    "APROBADO",
    "EN PROCESO",
    "LISTO",
    "ENTREGADO"
  ];

  const ordersRef = collection(db, "ordenes");

  const q = query(ordersRef, orderBy("creadoEn", "desc"));

  onSnapshot(q, (snapshot) => {
    const container = document.getElementById("ordersContainer");
    container.innerHTML = "";

    snapshot.forEach(doc => {
      const data = doc.data();
      container.innerHTML += renderOrden(data);
    });
  });

  function renderOrden(o) {
    return `
      <div class="order-card">
        <div class="order-header">
          <div class="placa">${o.placa}</div>
          <div class="estado">${o.estado}</div>
        </div>

        <div class="info"><b>VehÃ­culo:</b> ${o.vehiculo}</div>
        <div class="info"><b>Cliente:</b> ${o.cliente.nombre}</div>
        <div class="info"><b>Tel:</b> ${o.cliente.telefono}</div>

        <div class="timeline">
          ${estados.map(e =>
            `<div class="step ${e === o.estado ? "active" : ""}">${e}</div>`
          ).join("")}
        </div>
      </div>
    `;
  }

  window.crearOrden = async function () {
    await addDoc(ordersRef, {
      codigo: `TP360-CO-${Date.now()}`,
      placa: "ABC123",
      vehiculo: "Chevrolet Spark",
      cliente: {
        nombre: "Juan PÃ©rez",
        telefono: "3001234567"
      },
      estado: "INGRESO",
      timeline: [
        { estado: "INGRESO", fecha: serverTimestamp() }
      ],
      creadoEn: serverTimestamp(),
      actualizadoEn: serverTimestamp()
    });
  };
</script>

</body>
</html>